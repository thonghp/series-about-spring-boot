# Khái niệm

## Mục lục nội dung

- [1. Kiến trúc hệ thống](#1-kiến-trúc-hệ-thống)
- [2. Trực tiếp và chuyển hướng](#2-trực-tiếp-và-chuyển-hướng)
- [3. Bcrypt](#3-bcrypt)
- [4. Restful và web truyền thống](#4-restful-và-web-truyền-thống)
- [5. Spring mvc và Spring rest](#5-spring-mvc-và-spring-rest)
- [6. Thymeleaf](#6-thymeleaf)
- [7. HTTP](#7-http)
- [8. Cookie](#8-cookie)
- [9. Session](#9-session)
- [10. Local Storage](#10-local-storage)
- [11. Session storage](#11-session-storage)
- [12. Spring boot và Spring](#12-spring-boot-và-spring)

# 1. Kiến trúc hệ thống

![architecture](/assets/architecture.jpg)

- Code sẽ được viết trong 4 layer view, controller, service, repository
- Khi client gửi request nó sẽ đến controller layer > service sẽ thực hiện logic > render view
- View (Thymeleaf)
  - Sử dụng code html + thymeleaf để render ra giao diện.
- Controller (MVC, REST)
  - Sử dụng Spring MVC Controller, REST Controller hay RESTFul webservices
- Service (business classes)
  - Chứa các lớp business
- Repository (entities & interfaces)
  - Chứa các entity class và repository interface
- Spring data jpa
  - Sử dụng hibernate framework như implementation of JPA
- Hibernate
  - Sử dụng jdbc driver giao tiếp vs database

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 2. Trực tiếp và chuyển hướng

Chuyển hướng sau đó tải lại trang web có lợi hơn trang web trực tiếp ở chổ:

- **Bảo mật ==>** chuyển hướng và tải lại trang web sẽ không lưu thông tin lại trong bộ nhớ cache của trình duyệt.
  - Sử dụng với các thông tin nhạy cảm như **tài khoản ngân hàng,...**
- **Xử lý dữ liệu ==>** Khi thực hiện các thao tác thay đổi dữ liệu như thêm, sửa, xóa thì chuyển hướng và tải lại trang web giúp xác định rõ hơn rằng một thao tác đã hoàn tất trước khi hiển thị trang web mới, đảm bảo rằng dữ liệu hiển thị trên trang web mới được cập nhật và chính xác.
- **Truyền thông tin ==>** Truyền thông tin giữa các **`request`** khác nhau bằng cách truyền các tham số trên URL hoặc sử dụng đối tượng **`RedirectAttributes`** trong Spring Boot.

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 3. Bcrypt

- password hashing **dựa trên Blowfish** (symmetric-key block cipher) và chức năng **crypt trong unix**
- Bảo mật cao, **một salt - một chuỗi ngẫu nhiên được thêm vào trước khi mã hoá**, chống rainbow table attack
  - rainbow table attack là sử dụng 1 bảng băm của các mật khẩu thông dụng hoặc mật khẩu chọn trước đó ==> mục đích để đối chiếu dựa trên bảng băm tương ứng
- Độ dài có thể tăng khi phần cứng nhanh hơn ==> làm chậm tấn công

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 4. Restful và web truyền thống

**Web truyền thống**

- Thường tải nhiều tài nguyên từ máy chủ.
- Thông thường không giữ lại bất kỳ thông tin gì về trạng thái của ứng dụng.
- Lưu trữ thông tin **`session`** trên máy chủ.
- Trả về trang lỗi được tạo ra bởi máy chủ.

**Restful**

- Các ứng dụng giao tiếp với nhau thông qua các giao thức HTTP như **`GET, POST, PUT, DELETE`**
- Truyền tải dữ liệu qua các định dạng đơn giản như **`JSON hoặc XML`**.
- Lưu trữ thông tin trong bộ nhớ hoặc trên máy khách.
- Sử dụng **`access token`** để xác thực người dùng và bảo mật ứng dụng.
- Trả về mã lỗi HTTP tương ứng với các lỗi xảy ra

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 5. Spring mvc và Spring rest

**Spring mvc**

- Triển khai web truyền thống.
- Sử dụng các phương thức HTTP như **`GET, POST, PUT, DELETE`** để xử lý các yêu cầu.
- Sử dụng **`HTML, XML và JSON`** để định dạng dữ liệu đầu vào và đầu ra.
- Hỗ trợ quản lý session.

**Rest**

- Triển khai ứng dụng web restful.
- Sử dụng các phương thức HTTP như **`GET, POST, PUT, DELETE`** để triển khai các ứng dụng web RESTful.
- Sử dụng **`XML và JSON`** để định dạng dữ liệu đầu vào và đầu ra.
- Không hỗ trợ quản lý session

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 6. Thymeleaf

Là một thư viện Java template engine cho phép tạo các trang web động, cung cấp các tính năng tích hợp với Spring Framework

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 7. HTTP

- Là một giao thức **phi trạng thái hay không trạng thái (stateless)**
- Trạng thái khi mà chưa có hiểu đơn giản là một máy chủ nó không hiểu 1 trình duyệt có đang truy cập vào nó hay không hoặc là truy cập mà nó không biết đến từ đâu

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 8. Cookie

**Quy trình hoạt động**

![cookie](/assets/cookie1.jpg)

**Một vài thuộc tính cookie**

![cookie](/assets/cookie2.jpg)

- Là một tệp văn bản nhỏ **chứa các thông tin** (ghi nhớ đăng nhập, theo dõi, quảng cáo,...) được **server gửi đến máy người dùng**. Browser sẽ lưu trữ và **gửi lại server** mỗi khi **người dùng request** đến server.
  - Nếu một cookie không set thời gian tồn tại mặc định nó sẽ bằng session
  - Nếu **`HttpOnly`** set bằng false thì chúng ta có thể truy cập **`document.cookie`** trên console devtool lúc này có thể xem cookie **`==>`** không nên set **`HttpOnly`** bằng **`false`** vì có thể dẫn đến tấn công XSS
- Dung lượng tối đa là 4kb
- **hash-based token (cookie) ==>** token được tạo ra bằng cách mã hóa thông tin user thành một chuỗi hash và ghi vào cookie của trình duyệt. Cách này sẽ nhanh và đơn giản nhưng không an toàn
- **persistent token (cookie + database) ==>** token được lưu trữ trong cơ sở dữ liệu của ứng dụng. Cách này sẽ chậm nhưng an toàn hơn
- **`JSESSSIONID`** cookie, do java web application tạo ra, là một cookie lưu trữ **SessionID**, cookie này sẽ hết hạn khi đóng browser

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 9. Session

**Quy trình hoạt động**

![session](/assets/session.jpg)

- Một session bắt đầu khi client gửi request đến server
- Nó tồn tại xuyên suốt từ trang này đến trang khác trong ứng dụng web
- Mất khi hết thời gian timeout hoặc khi bạn đóng ứng dụng.
- Giá trị của session sẽ được lưu trong một file trên server
- Là 1 vùng nhớ trên ram server

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 10. Local Storage

- Là một feature mới của HTML5 cho phép lưu trữ bất kì info trong browser dùng JavaScript
- Dung lượng tối đa 5mb/10mb
- Lưu trữ dữ liệu vĩnh viễn trên trình duyệt, trừ khi người dùng xóa cache hoặc clear web data
- Lưu data theo cặp **key/value** ở browser và server không access được các data này.
- Chỉ lưu 1 **`String`**, các kiểu data phức tạp không phù hợp để lưu
- Có thể bị đọc bởi js và xoá thông qua js hoặc thủ công

## 11. Session storage

Giống local storage chỉ khác:

- Dung lượng tối đa 5mb
- Khi đóng tab hay browser sẽ mất data

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## 12. Spring boot và Spring

**Spring boot**

- Xây dựng trên nền tảng của Spring Framework
- Tự động cấu hình cho ứng dụng và thư viện bên thứ 3 **==>** Spring MVC, view resolver, Spring Security, Spring Data JPA, Thymeleaf template engine,...
- Embedded web server: **Tomcat, Jetty hoặc Undertow** được tích hợp, cho phép chạy không cần triển khai trên một máy chủ riêng biệt **==>** không cần phải triển khai thủ công các tệp **`WAR`**
- **Starter Dependencies** giúp đơn giản hóa việc quản lý phụ thuộc của một dự án Java

**Sự khác nhau giữa Spring và Spring boot**

| Spring                            | Spring boot                              |
| --------------------------------- | ---------------------------------------- |
| Cấu hình rất nhiều XML            | ko có cấu hình XML                       |
| Quản lý version của dependency    | Starter dependency quản lý dependency    |
| External server (deploy dạng WAR) | Độc lập với máy chủ nhúng (JAR thực thi) |
| Thiết lập dự án lâu               | Thiết lập dự án nhanh                    |

**[⬆ Quay trở lại đầu trang](#mục-lục-nội-dung)**

## Xem thêm bài viết khác

- [Config](Day001.md)
- [Entity](Day003.md)
